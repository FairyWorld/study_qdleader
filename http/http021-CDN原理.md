# CDN 原理解析

CDN (全称 Content Delivery Network)，即内容分发网络。

## 一、基本概念

CDN 是一种通过互联网互相连接的计算机网络系统，它能够将源站内容分发至全球各地的节点服务器，使用户可以就近获取所需内容。
简单来讲，CDN 就是根据用户位置分配最近的资源

### 主要特点：

1. 分布式存储
2. 智能调度
3. 负载均衡
4. 就近访问

## 二、工作原理

### 1. 传统访问模式

用户访问未使用 CDN 的网站流程：

1. 用户输入域名
2. 本地 DNS 解析获取 IP
3. 直接访问源站服务器
4. 获取数据返回

### 2. CDN 访问模式

使用 CDN 后的访问流程：

1. 用户输入域名
2. 本地 DNS 解析到 CDN 专用 DNS 服务器
3. CDN 的 DNS 服务器返回 CNAME 记录
4. 智能调度系统选择最优节点
5. 返回边缘节点 IP
6. 用户访问边缘节点获取数据

### 3. CDN 调度策略

CDN 系统通过全局负载均衡（GSLB）实现最优节点选择：

- **地理位置判断**：根据用户 IP 选择最近节点
- **网络条件判断**：
  - 节点服务器负载状况
  - 节点带宽容量
  - 用户所在运营商网络
  - 节点响应时间
- **内容判断**：
  - 节点是否有缓存所需内容
  - 内容是否过期

### 4. 缓存机制

CDN 边缘节点的缓存策略：

- 当用户首次请求某内容时，边缘节点会从源站拉取
- 将内容缓存在本地，设定缓存过期时间
- 其他用户请求相同内容时直接从边缘节点获取
- 定期检查缓存内容是否过期，及时更新

## 三、CDN 优势

1. **提升访问速度**：就近访问，减少网络跳转
2. **减轻源站压力**：分散源站访问压力
3. **提高可用性**：多节点备份，防止单点故障
4. **节省带宽成本**：合理利用边缘节点带宽
5. **防御网络攻击**：分散式架构天然抵御 DDoS 攻击

## 四、应用场景

1. 静态资源加速（图片、CSS、JS 等）
2. 视频点播/直播加速
3. 大文件下载加速
4. 全站加速
